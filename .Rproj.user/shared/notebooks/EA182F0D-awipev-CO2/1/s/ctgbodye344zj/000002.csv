"0","#"
"0","Sys.setlocale(""LC_ALL"", ""en_US.UTF-8"")"
"1","[1]"
"1"," ""en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8"""
"1","
"
"0","Sys.setenv(TZ='UTC') # on utilise UTC"
"0","rm(list = ls())"
"0","library(tidyverse)"
"0","library(robfilter)"
"0","library(seacarb)"
"0","library(gridExtra)"
"0","library(reshape2)"
"0","library(lubridate)"
"0","library(lmtest)"
"0","library(grid)"
"0","library(viridis)"
"0","library(dygraphs)"
"0","require(""knitr"")"
"0","library(""lmodel2"")"
"0","library(captioner)"
"0","library(xts)"
"0","library(seismicRoll)"
"0","library(scales)"
"0","knitr::opts_chunk$set(echo = TRUE)"
"0","fig_nums <- captioner()"
"0","table_nums <- captioner(prefix = ""Table"")"
"0","#define who is the user and define path"
"0","if (Sys.getenv(""LOGNAME"") == ""gattuso"") path = ""../../pCloud\ Sync/Documents/experiments/exp168_awipev-CO2/"""
"0","if (Sys.getenv(""LOGNAME"") == ""samir"") path = ""../../pCloud\ Sync/exp168_awipev-CO2/"""
"0","######## function to make regression plot with model I equation in title"
"0","ggreg <- function (fit, point_size=2) {"
"0","  ggplot(fit$model, aes_string(x = names(fit$model)[2],"
"0","                               y = names(fit$model)[1])) +"
"0","    geom_point(size = point_size, col = ""blue"") +"
"0","    stat_smooth(method = ""lm"", col = ""black"") +"
"0","    labs(title = paste(title, ""\nAdj R2 = "",signif(summary(fit)$adj.r.squared, 5),"
"0","                       ""; Intercept ="",signif(fit$coef[[1]],5 ),"
"0","                       ""; Slope ="",signif(fit$coef[[2]], 5),"
"0","                       ""; P ="",signif(summary(fit)$coef[2,4], 5))) +"
"0","    theme(plot.title = element_text(size=7))"
"0","}"
"0","#################### which.closest function"
"0","which.closest <- function(x, table, ...) {"
"0","  round(approx(x=table, y=1:length(table), xout=x, ...)$y)"
"0","}"
"0","#################### Regression function"
"0","# function regression plot with model II equation (MA) in title"
"0","## Dans labs ajout de la variable title pour mettre title avant chaque graphe"
"0","ggreg2 <- function (fit, x, y, point.size=5) { # x and y are the names of the variables"
"0","  fit_data <- data.frame(fit$x, fit$y)"
"0","  colnames(fit_data) = c(x, y)"
"0","reg <- fit$regression.results[2,] #one selects MA only"
"0","intercept <- reg$Intercept"
"0","slope <- reg$Slope"
"0","  ggplot(data = fit_data, aes_string(x = x, y = y)) + "
"0","  geom_point(size = point.size, col = ""blue"") +"
"0","  geom_abline(aes(intercept = fit$regression.results[2,2], slope = fit$regression.results[2,3]),"
"0","              colour = ""blue"") +"
"0","  labs(title = paste(title,""\n Adj R2 = "", signif(fit$rsquare, 3),"
"0","                     ""; Intercept ="", signif(intercept, 3),"
"0","                     ""; Slope ="", signif(slope, 3),"
"0","                     ""; P ="", signif(fit$P.param, 3))) +"
"0","    theme(plot.title = element_text(size=7))"
"0","}"
"0","#################### Mytheme"
"0","Mytheme <- function(size_labs = 7, face_font=""plain"") {"
"0","  theme_bw() +"
"0","  theme(axis.text.x = element_text(face=face_font, size=size_labs, color=""black""),"
"0","        axis.title.x = element_text(face=face_font, size=size_labs),"
"0","        axis.text.y = element_text(face=face_font, color=""black"", size=size_labs),"
"0","        axis.title.y = element_text(face=face_font, size=size_labs),"
"0","        axis.ticks.x = element_line(size=0.1),"
"0","        axis.ticks.y = element_line(size=0.1),"
"0","        axis.ticks.length = unit(1.1, ""mm""),"
"0","        panel.grid.major = element_line(size = 0.25, color=""black"", linetype=""dashed""),"
"0","        aspect.ratio = 1 / 2,"
"0","        plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = ""cm"")"
"0","  )"
"0","}"
"0","ggplotRegression <- function(fit){"
"0","require(ggplot2)"
"0","ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + "
"0","  geom_point() +"
"0","  stat_smooth(method = ""lm"", col = ""red"", se= FALSE) +"
"0","  labs(title = paste(""Adj R2 = "",signif(summary(fit)$adj.r.squared, 5),"
"0","                     ""Intercept ="",signif(fit$coef[[1]],5 ),"
"0","                     "" Slope ="",signif(fit$coef[[2]], 5),"
"0","                     "" P ="",signif(summary(fit)$coef[2,4], 5)))"
"0","}"
