"0","#Interpolation of continuous sensor data to match a maximum of reference data."
"0","TAinterp_all <-approx(d_all$datetime, d_all$AT_filtered, xout=d_all$datetime, method=""linear"", rule=2)"
"0","names(TAinterp_all) <- c(""datetime"", ""AT_filtered_interp"")"
"0","TAinterp_all <- as.data.frame(TAinterp_all)"
"0","d_all$AT_filtered_interp <- TAinterp_all$AT_filtered_interp"
"0","# create a column with difference between sensor and ref"
"0","d_all <- d_all%>%"
"0","  dplyr::mutate(diff_ta =  at-AT_filtered_interp )"
"0","# create colum with instrument number"
"0","d_all <- d_all %>% "
"0","  dplyr::mutate(TA_period= ifelse(datetime >= ""2016-02-26 00:00:00"" & datetime < ""2017-02-09 12:00:00"", ""TA1"","
"0","                            ifelse(datetime >= ""2017-02-09 12:00:00"" & datetime < ""2017-03-10 12:00:00"", ""TA2"","
"0","                            ifelse(datetime >= ""2018-01-07 00:00:00"" & datetime < ""2018-06-20 00:00:00"", ""TA3"", "
"0","                            ifelse(datetime >= ""2018-07-31 00:00:00"" & datetime < ""2018-10-31 00:00:00"", ""TA4"", "
"0","                            ifelse(datetime >= ""2019-01-26 00:00:00"" , ""TA5"", ""TA0""))))))"
"0","#remove outliers"
"0","calib_ta_first <- d_all%>%"
"0","  dplyr::select(datetime, closest_datetime,AT_filtered, AT_filtered_interp, at,diff_ta,TA_period)%>%"
"0","  dplyr::filter(TA_period ==""TA1"" & !is.na(at))"
"0","  #dplyr::filter( !is.na(at))#, diff_ta > -40 & diff_ta < 20 )"
"0","# & datetime != ""2016-08-18 08:00:00"" & datetime != ""2016-12-29 12:00:00 "",!is.na(at))"
"0","# Parameters of regression"
"0","fit <- lm( data=calib_ta_first%>%filter(diff_ta <= 50), diff_ta ~ datetime)"
"0","at_slope_TA1 <- round(fit$coefficients[[2]] , digits=6)"
"0","at_slope1 <- round(at_slope_TA1 * 3600 *24 * 365.24, digits=2)"
"0","at_intercept1 <- round(fit$coefficients[[1]], digits= 2)"
